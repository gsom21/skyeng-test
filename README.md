# Ответы на вопросы 

###1

a) Можно запустить задачу по формированию отчета асинхронно, после того как отчет
будет готов в интерфейс клиента через WebSocket можно отправить сообшение что он готов.

б) Можно формировать отчет по крону (к примеру раз в 10, 15 минут), клиенту отдавать последний созданный отчет

в) Можно использовать Clickhouse он как раз создан для работы с аналитическими данными, скорее всего данные за 
10 лет он отдаст очень быстро.

###2

Первым делом смотрим в сниффер в браузере (вкладочка в консоле), если проблема в куче http запросов, то
делаем следуещее. Мнифицируем css, js сжимаем в один файл кэшируем в браузере. Картинки, если они жирные можем их конвертнуть в 
jpeg сжать, обьеденить их в один спрайт, либо можем реализовать lazyload  на странице и грузить картинки по мере прокрутки страницы.
Если с загрузкой на сервере, долго выполняется какой то php скрипт, то достаем профайлер и что так долго отрабатывает.
Может какой то цикл изощренный, или дело в регулярках, если дело в пхп, код можно вынести в отдельный микросервис на go, rust ... :)  но обычно самое узкое место это бд.
Если долго выполняется запрос в бд, то причин и вариантов решения может быть множество, зависит от конкретной проблемы.
Что можно поделать: 
explain analyze, можем добавить индексы,
возможно в запросе джойнится куча таблиц, 
возможно все дело в full outer join, можно что то денормализовать,
если дело в жирных таблицах то можно их партиционировать, 
можно настроить шардирование, кэширование, можно посмотреть в стороноу колоночных баз данных
clickhouse, vertica, hbase и тд

###3
 
 Если я правильно впорос понял то, одни конфиги для прода другие для дева. Все в гитигнор, что бы доступов к проду не было в репозитории, 
 дев конфиги у разработчиков обычно разные (тк разные песочницы) поэтому в репозитории их хранить нет смысла.
 
###4

Проверям регуляркой, отсылаем емэйл с ссылкой для подтверждения регистрации.

## Практика

###1

C yii работал мало + делал поздно вечером так что наверняка все не самым лучшим образом сделал.

###2

```
memcache_connect('localhost', 11211);

function($date, $type) {
    $userId = Yii::$app->user->id;
    $key = 'date'.$date.'type'.$type.'id'.$id;
    $dataList = memcache_get($key);
    if(!$dataList){
        $dataList = SomeDataModel::find()->where(['date' => $date, 'type' => $type, 'user_id' => $userId])->all();
        memcache_set($key, $dataList, 60*60)
    }
    $result = [];
     
    if (!empty($dataList)) {
        foreach ($dataList as $dataItem) {
            $result[$dataItem->id] = ['a' => $dataItem->a, 'b' => $dataItem->b];
        }
    }
    
    return $result;
}

```

###3

Структуру можно посмотреть в миграции 
 
 

